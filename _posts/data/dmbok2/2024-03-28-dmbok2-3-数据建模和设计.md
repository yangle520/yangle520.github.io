---
layout: post
title:  DMBOK 数据建模和设计
date:   2024-03-27 00:00:00 +0800
categories: DMBOK
tag: 大数据
author: YangLe
---

   ## 一、基本概念

   ### 定义

   数据建模是发现、分析和确定数据需求的过程，然后采用数据模型的精确形式表示和传递这些数据需求。

   数据模型有助于组织能够理解其数据资产，数据建模的直接成果不是数据库，而是对组织数据的理解。

   数据建模最常见的模式：关系模式、多维模式、面向对象模式、事实模式、时间序列模式、NoSQL模式

   每种模式又可以分为三层模型（不是所有的都可以分为三类）：概念模型、逻辑模型、物理模型。

   每种模型都包含一系列组件，如实体、关系、事实、键和属性。

   

   ### 语境图

   ![图片]({{ '/images/data/数据建模与设计语境图.png' | prepend: site.baseurl }})

   

   ### 业务驱动因素

   数据模型对于有效的数据管理至关重要，驱动组织进行数据建模和设计的常见业务因素如下：

   - 提供有关数据的通用词汇表。
   - 获取、记录组织内数据和系统的详细信息。
   - 在项目中作为主要的交流沟通工具。
   - 提供了应用定制、整合，甚至替换的起点。

   良好的数据建模会降低支持成本，增加未来需求重复利用的可能性，从而降低构建新应用的成本。数据模型是元数据的一种重要形式

   

   ### 目标

   数据建模的目标是确认和记录不同视角对数据需求的理解，从而使应用程序与当前和未来的业务需求更加紧密地结合在一起，并为成功地完成广泛的数据应用和管理活动奠定基础。

   

   ### 活动

   #### 规划数据建模

   评估组织需求、确定建模标准、明确数据模型存储等任务

   #### 建立数据模型

   一个不断迭代的过程，不断进行优化，直到满足业务诉求。常见的建立数据模型的方法包括正向工程和逆向工程

   正向工程：从需求开始构建应用程序的过程。首先通过概念模型来理解需求的范围和核心的术语。然后建立逻辑模型详细描述业务过程。最后通过具体的建表语句来实现物理模型。

   逆向工程：记录现有数据库的过程。物理数据建模通常是第一步，以了解现有系统的技术设计；逻辑数据建模是第二步，以记录现有系统满足业务的解决方案；概念数据建模是第三步，用于记录现有系统中的范围和关键术语。

   #### 审核数据模型

   持续改进、模型评估和正式发布。

   #### 维护数据模型

   数据模型需要保持最新状态。在维护数据模型时一个好的习惯是对最新的物理数据模型进行逆向工程，并确保它与相应的逻辑数据模型保持一致。许多数据建模工具可以自动比较物理模型与逻辑模型差异

   

   数据建模工作交付成果包括以下4个方面：

   - 图表：一个数据模型包含若干个图表，图表是一种以精确的方式描述需求的形式。
   - 定义：实体、属性和关系的定义对于维护模型的精度至关重要。
   - 争议而悬而未决的问题：数据建模过程经常出现可能无法解决的一些争议和问题。因此，通常数据建模工作交付的文档应包含当前的议题和未解决的问题。
   - 血缘关系：血缘关系在数据建模过程中非常重要，有以下两个原因：一是有助于数据建模人员深入理解数据需求，准确定位属性来源；二是确定属性在源系统中的情况，这是验证模型和映射关系准确性的有效工具。

   

   ## 二、数据建模核心概念

   ### 实体

   实体定义是有别于其他事物的一个事物，是一个组织收集信息的载体

   实体在不同层级模型中的叫法不同：

   - 概念模型：概念concept/术语term
   - 逻辑模型：实体entity
   - 物理模型：表table

   ### 关系

   关系是实体之间的关联。

   关系捕获概念实体之间的高级别交互、逻辑实体之间的详细交互和物理实体之间的约束。

   关系有一些内在的属性，如基数，元数等：

   - 关系的基数：一对一、一对多、多对多关系
   - 关系的元数：涉及到的实体的个数，一元关系、二元关系、三元关系等

   ### 属性

   属性是定义、描述和度量实体某方面的性质。

   属性中的标识符，也称为键。

   按照结构分：单一键、组合键（多个属性集合）、复合键（组合键 + 其他）、代理键（也是单一键，表的唯一标识符，技术上的自增ID）

   按照功能分：候选键（标识实体实例的最小属性集合，可能包含一个或多个属性）、主键（被选为实体唯一标识符的候选键）、超键（唯一标识实体实例的任何属性集）、备用键（没有被选为主键的候选键）——一般主键是代理键，备用键是业务键

   ### 域

   域代表某一属性可被赋予的全部可能取值，也被称为值域。

   

   ## 三、常用数据建模方法

   | 建模方法                    | 表示法                                                       |
   | --------------------------- | ------------------------------------------------------------ |
   | 关系（Relational）          | 信息工程（IE）<br />信息建模集成定义（IDEFIX）<br />巴克符号（Barker Notation）<br />陈氏符号（Chen） |
   | 维度（Dimensional）         | 维度（Dimensional）                                          |
   | 面向对象（Object-Oriented） | 统一建模语言（UML）                                          |
   | 基于事实（Fact-Based）      | 对象角色建模（ORM2）<br />完全面向交流的信息建模（FCO-IM）   |
   | 基于时间（Time-Based）      | 数据拱顶模型（Data Vault）<br />锚建模（Anchor Modeling）    |
   | 非关系（NoSQL）             | 文档（Document）<br />列（Column）<br />图（Graph）<br />键值（Key-Value） |

   

   ### 关系建模

   关系建模是一种能够清晰表达含义的组织数据的系统方法，在减少数据存储冗余方面卓有成效，特别适合设计操作型的系统。最常见的就是信息工程法，用三叉线表示基数

   ![图片]({{ '/images/data/信息工程表示法.png' | prepend: site.baseurl }})

   

   ### 维度建模

   维度建模的理念是，数据组织的方式是为了优化海量数据的查询和分析。

   维度建模主要包括下面概念：

   - 事实表：特定的数值型度量值。如金额、交易量。往往占据数据库的大部分空间
   - 维度表：表示业务的重要对象，主要包含文字描述。如用户信息，地区信息
   - 粒度：事实表中单行数据的含义或描述，如日期、地区、用户等

   ![图片]({{ '/images/data/维度模型的轴表示法.png' | prepend: site.baseurl }})

   

   ### 非关系型数据库

   NoSQL： Not only SQL。不是关于如何查询数据库，而是关于如何存储数据的。通常有四类：文档数据库、键值数据库、列数据库、图数据库。

   

   ## 四、模型

   ### 1、概念模型 CDM

   一系列相关主题域的集合来描述概要数据需求。概念数据模型仅包括给定的领域和职能中基础和关键的业务实体，同时也给出实体和实体之间关系的描述。

   ![图片]({{ '/images/data/概念建模.png' | prepend: site.baseurl }})

   

   ### 2、逻辑模型 LDM

   对数据需求的详细描述，通常用于支持特定用法的语境中（如应用需求）。逻辑模型不受任何技术或特定实施条件的约束，逻辑数据模型通常是从概念数据模型扩展而来。

   ![图片]({{ '/images/data/逻辑建模.png' | prepend: site.baseurl }})

   

   ### 3、物理模型 PDM

   描述了一种详细的技术解决方案，通常以逻辑模型为基础，与某一类系统硬件、软件和网络工具相匹配。物理模型与特定技术相关

   ![图片]({{ '/images/data/物理建模.png' | prepend: site.baseurl }})

   

   ## 五、规范化

   规范化（Normalization）是运用规则将复杂的业务转化为规范的数据结构的过程。范式化的基本目标是保证每个属性只在一个位置出现，以消除冗余或冗余导致的不一致性。范式的层次包括：

   1. 第一范式（1NF）：确保每个实体都有一个有效的主键，每个属性都依赖于主键，而且消除冗余的分组，以确保每个属性的原子性（不能有多个值存在）。第一范式包括了与通常称为关联实体的附加实体的多对多关系解析。
   2. 第二范式（2NF）：确保每个实体都有最小的主键，每个属性都依赖于完整的主键。
   3. 第三范式（3NF）：确保每一个实体都没有隐藏的主键，每个属性都不依赖于键值之外的任何属性（仅依赖于完整的主键）。

   实践中一般达到第三范式即可，4NF，5NF很少出现。DAMA对范式的解释有点官方，为了帮助理解，可以参考：

   - 1NF：字段不可分；原子性 字段不可再分，否则就不是关系型数据库
   - 2NF：有主键，非主键字段依赖主键；唯一性 一个表只说明一个事物
   - 3NF：每列都与主键有直接关系，不存在传递依赖

   

   

   ## 六、数据建模和设计质量管理

   ### 开发数据建模和设计标准

   数据建模和数据库设计标准应包括以下内容：

   1. 标准数据建模和数据库设计可交付成果的列表和描述
   2. 适用于所有数据模型对象的标准名称、可接受的缩写和非常用单词的缩写规则列表。
   3. 所有数据模型对象的标准命名格式列表，包括属性和分类词。
   4. 用于创建和维护这些可交付成果的标准方法的列表和说明。
   5. 数据建模和数据库设计角色和职责的列表和描述。
   6. 数据建模和数据库设计中捕获的所有元数据属性的列表和描述，包括业务元数据和技术元数据。例如，指导原则中可以设置数据模型为每个属性捕获数据血缘的期望。
   7. 元数据质量期望和要求
   8. 如何使用数据建模工具的指南。
   9. 准备和领导设计评审的指南。
   10. 数据模型版本控制指南。
   11. 禁止或需要避免的事项列表。
