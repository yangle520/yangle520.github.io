---
layout: post
title: 系统架构设计师教程 - 2.7
subtitle: 系统性能
date:   2023-01-02 00:00:00
categories: 软考 系统架构设计师教程
tag: 软考
author: YangLe
---





系统性能是一个系统提供给用户的所有性能指标的集合。它既包括硬件性能（如 处理器主频、存储器容量、通信带宽 等）和 软件性能（如 上下文切换、延迟、执行时间 等），也包括部件性能指标和综合性能指标。

系统性能包含**性能指标**、**性能计算**、**性能设计**、**性能评估** 4个方面的内容。



## 一、性能指标

性能指标是软、硬件的性能指标的集成。

- 在硬件中包括：计算机、各种通信交换设备、各类网络设备 等
- 在软件中包括：操作系统、数据库、网络协议、应用程序 等



### 1 计算机的性能指标

| 指标                                      | 说明                                                         | 度量                                                         | 示例                                                         |
| ----------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 时钟频率（主频）                          | CPU 的工作节拍是由主时钟来控制的，主时钟不断产生固定频率的时钟脉冲，这个主时钟的频率即是CPU的主频。<br />主频越高，CPU 的工作节拍越快，运算速度也就越快。<br />但现在多核成为 CPU 发展的重要方向，原来单以时钟频率计算性能的方式已经不合适了，还得看单个CPU中的内核数。（如 8核、12核等） |                                                              |                                                              |
| 运算速度                                  | 取决于给定时间内 CPU 所能处理的数据量和CPU的主频             | MIPS (百万条指令/秒)<br />MFLOPS(百万次浮点运算/秒)          | MIPS 用于描述计算机的定点运算能力<br />MFLOPS 用来表示计算机的浮点运算能力 |
| 运算精度                                  | 即计算机处理信息时 能直接处理的二进制数据的位数，位数越多，精度就越高。 | 基本字长：<br />8位<br />16位<br />32位<br />64位            | PC一般为32位、64位<br />大中型计算机一般为32位、64位<br />巨型机一般为64位<br />单片机一般是8位、16位 |
| 内存的存储容量                            | 内存的容量越大，可存储的数据和程序就越多，从而减少与磁盘信息交换的次数，使运行效率得到提高。<br /> | 字节（Byte）                                                 | PC：1G ~ 8G<br />大型机：上百GB                              |
| 存储器的存取周期                          | 内存完成一次读或写操作所需的时间称为存储器的**存取时间**（或访问时间）。<br />连续两次读或写所需的最短时间称为**存储周期** | ns (10的-9次方秒)                                            |                                                              |
| 数据处理速率（Processing Data Rate，PDR） | 主要用来度量 CPU 和 主存储器的速度，他没有涉及高速缓存和多功能等。因此，PDR 不能度量机器的整体速度。 |                                                              | PDR = L / R<br /> L = 0.85G + 0.15H + 0.4J + 0.15K<br />R = 0.85M + 0.09N + 0.06P<br /><br />G -> 每条定点指令的位数<br />H -> 每条浮点指令的位数<br />J -> 定点操作数的位数<br />K -> 浮点操作数的位数<br />M -> 平均定点加法时间<br />N -> 平均浮点加法时间<br />P -> 平均浮点乘法时间 |
| 吞吐率                                    |                                                              |                                                              |                                                              |
| 各种响应时间                              | 某一事件从发生到结束的这段时间<br />响应时间既可以使原子的，也可以是由几个响应时间复合而成的。 | 秒                                                           | 0.1秒：用户感觉不到任何延迟<br />1秒：用户愿意接受的时间极限<br />10秒：用户保持注意力执行本次任务的极限 |
| 各种利用率                                |                                                              |                                                              |                                                              |
| RASIS 特性                                | 可靠性（Reliability）：计算机系统在规定的工作条件下和规定的工作时间内持续正确运行的概率<br />可用性（Availability）<br />可维护性（Serviceability）：系统发生故障后能尽快修复的能力<br />完整性（Integrity）<br />安全性（Security） | 平均无故障时间(MTTF)<br />平均故障间隔时间（MTBF）<br />平均故障修复时间（MTTR） |                                                              |
| 平均故障响应时间（TAT）                   | 从出现故障到该故障得到确认修复前的这段时间。<br />该指标反应的是服务水平。TAT越短，对用户系统影响越小 |                                                              |                                                              |
| 兼容性                                    | 是指一个系统的硬件或软件与另外一个系统或多种操作系统的硬件或软件的兼容能力，是指系统间某些方面具有的并存性，即两个系统之间存在一定程度的通用性。 |                                                              | 数据和文件的兼容<br />程序和语言级的兼容<br />系统程序的兼容<br />设备的兼容<br />向上兼容<br />向后兼容 |
| 可扩充性                                  |                                                              |                                                              |                                                              |
| 性能价格比                                |                                                              |                                                              |                                                              |



### 2 路由器的性能指标

| 指标               | 说明 |
| ------------------ | ---- |
| 设备吞吐量         |      |
| 端口吞吐量         |      |
| 全双工线速转发能力 |      |
| 背靠背帧数         |      |
| 路由表能力         |      |
| 背板能力           |      |
| 丢包率             |      |
| 时延               |      |
| 时延抖动           |      |
| VPN支持能力        |      |
| 内部时钟精度       |      |
| 队列管理机制       |      |
| 端口硬件队列数     |      |
| 分类业务带宽保证   |      |
| RSVP               |      |
| IP DiffServ        |      |
| CAR 支持           |      |
| 冗余               |      |
| 热插拔组件         |      |
| 路由器冗余协议     |      |
| 网管               |      |
| 基于Web的管理      |      |
| 网管类型           |      |
| 带外网管支持       |      |
| 网管粒度           |      |
| 计费能力/协议      |      |
| 分组语音支持方式   |      |
| 协议支持           |      |
| 语音压缩能力       |      |
| 端口密度           |      |
| 信令支持           |      |



### 3 交换机的性能指标

| 指标                                    | 说明                                       |
| --------------------------------------- | ------------------------------------------ |
| 类型                                    |                                            |
| 配置                                    |                                            |
| 支持的网络类型                          |                                            |
| 最大 ATM 端口数                         |                                            |
| 最大 SONET 端口数                       |                                            |
| 最大 FDDI 端口数                        |                                            |
| 背板吞吐量                              |                                            |
| 缓冲区大小                              |                                            |
| 最大 MAC 地址表大小                     |                                            |
| 最大电源数                              |                                            |
| 支持协议和标准                          |                                            |
| 路由器信息协议（RIP）                   |                                            |
| RIP2                                    |                                            |
| 开放式最短路径优先第2版                 |                                            |
| 边界网关协议（BGP）                     |                                            |
| 无类别域间路由（CIDR）                  |                                            |
| 互联网成组管理协议（IGMP）              |                                            |
| 距离矢量多播路由协议（DVMRP）           |                                            |
| 开放式最短路径优先多播路由协议（MOSPF） |                                            |
| 协议无关的多播协议（PIM）               |                                            |
| 资源预留协议（RSVP）                    |                                            |
| 802.1p优先级标记                        |                                            |
| 多队列                                  |                                            |
| 路由                                    |                                            |
| 支持第三层交换                          |                                            |
| 支持多次（4~7）层交换                   |                                            |
| 支持多协议路由                          |                                            |
| 支持路由缓存                            |                                            |
| 可支持最大路由表数                      |                                            |
| VLAN                                    |                                            |
| 最大 VLAN 数量                          |                                            |
| 网管                                    |                                            |
| 支持网管类型                            |                                            |
| 支持端口镜像                            |                                            |
| QoS                                     |                                            |
| 支持基于策略的第2层交换                 |                                            |
| 每端口最大优先级队列数                  |                                            |
| 支持基于策略的第3层交换                 |                                            |
| 支持基于策略的应用级QoS                 |                                            |
| 支持最小/最大优先级队列数               |                                            |
| 冗余                                    |                                            |
| 热交换组件                              | 管理卡、交换结构、接口模块、电源、冷却系统 |
| 支持端口链路聚集协议                    |                                            |
| 负载均衡                                |                                            |



### 4 网络的性能指标

| 指标分类       | 说明                                                         |
| -------------- | ------------------------------------------------------------ |
| 设备级性能指标 | 网络设备提供的通信量的特征，是确定网络性能的一个重要因素<br />计算机网络设备(主要指路由器)的标准性能指标包括：吞吐量、延迟、丢包率、转发速度等 |
| 网络级性能指标 | 可达性、网络系统的吞吐量、传输速率、信道利用率、信道容量、带宽利用率、丢包率、平均传输延迟、平均延迟抖动、延迟/吞吐量的关系、延迟抖动/吞吐量的关系、丢包率/吞吐量的关系 等 |
| 应用级性能指标 | QOS、网络对语言应用的支持程度、网络对视频应用的支持度、延迟/服务质量的关系、丢包率/服务质量的关系、延迟抖动/服务质量的关系 等 |
| 用户级性能指标 | 可靠性、可用性                                               |
| 吞吐量         | 在没有帧丢失的情况下，设备能够接受的最大速率。可以帮助寻找网络路径中的瓶颈<br />网络吞吐量非常依赖当前网络的负载情况。网络吞吐量定义为剩余带宽是有实际意义的 |



### 5 操作系统的性能指标

| 指标             | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| 系统上下文切换   |                                                              |
| 系统响应时间     | 是指用户从提交作业到得到计算结果这段时间，又称周转时间       |
| 系统的吞吐率(量) | 系统在单位时间内所处理的信息量，以每小时或每天所处理的各类作业数量来度量 |
| 系统资源利用率   | 指系统中各个部件、各种设备的使用程度。它用在给定时间内，某一设备实际使用时间所占的比例来度量 |
| 可靠性           |                                                              |
| 可移植性         |                                                              |



### 6 数据库管理系统的性能指标

| 指标                   | 说明 |
| ---------------------- | ---- |
| 数据库大小             |      |
| 数据库表的数量         |      |
| 单个表的大小           |      |
| 表中允许的记录(行)数量 |      |
| 单个记录(行)的大小     |      |
| 表上所允许的索引数量   |      |
| 数据库所允许的索引数量 |      |
| 最大并发事务处理能力   |      |
| 负载均衡能力           |      |
| 最大连接数             |      |



### 7 Web服务器的性能指标

| 指标           | 说明 |
| -------------- | ---- |
| 最大并发连接数 |      |
| 响应延迟       |      |
| 吞吐量         |      |



## 二、性能计算

性能指标计算的主要方法有：

- 定义法
- 公式法
- 程序检测法
- 仪器检测法

常用的性能指标计算过程（MIPS）的计算方法：

- 峰值计算
- 等效指令速度法（吉普森法，Gibson）

在实际应用中，往往是对这些常用性能指标的复合计算，然后通过算法加权处理得到最终结果。



## 三、性能设计

1 性能调整



## 四、性能评估

性能评估是为了一个目的，按照一定的步骤，选用一定的度量项目，通过建模和实验，对一个系统的性能进行各项检测，对测试结果做出解释，并形成一份文档的技术。

性能评估的一个目的是为性能的优化提供参考。



### 1 基准测试程序

把应用程序中用的最多、最频繁的那部分核心程序 作为评价计算性能的标准程序，称为 **基准测试程序**（benchmark）。

评价程序：

- 真实的程序
- 核心程序
- 小型基准程序
- 合成基准程序

基准测试程序有：

- 整数测试程序：Dhrystone。用 C 语言编写，100 条语句。包括：各种赋值语句，各种数据类型和数据区，各种控制语句，过程调用和参数传送，整数运算、逻辑操作。
- 浮点测试程序：Linpack。
- Whetstone 基准测试程序
- SPEC 基准测试程序
- TPC 基准程序
- Linpack 测试



### 2 Web服务器的性能评估

在 Web 服务器的测试中，反映其性能的指标主要有：**最大并发连接数**、**响应延迟**、**吞吐量** 等。

常见的 Web 服务器形象评测方法有 **基准性能测试**、**压力测试**、**可靠性测试**。

- 基准测试：即采用前面所提到的各种基准程序对其进行测试

- 压力测试：即采用一些测试工具（主要是能模拟足够数量的并发操作）来测试 Web 服务器的一些性能指标。还可以找到服务器的瓶颈所在，然后通过参数调整，让服务器运行的更高效。

  



### 3 系统监视

系统监视的目的是为了评估系统性能。要监视系统性能，需要收集某个时间段内的 3 种**不同类型的性能数据**：

1. **常规性能数据**：该信息可帮助识别短期趋势（如内存泄漏）。经过一两个月的数据收集后，可以求出结果的平均值 并用更紧凑的格式保存这些结果。这种存档数据可帮助人们在业务增长时做出容量规划，并有助于在日后评估上述规划的效果。
2. **比较基准的性能数据**：该信息可帮助人们发现缓慢、历经长时间才发生的变化。通过将系统的当前状态与历史记录数据相比较，可以排除系统问题并调整系统。由于该信息只是定期收集的，所以不必对其进行压缩存储。
3. **服务水平报告数据**：该信息可帮助人们确保系统能满足一定的服务或性能水平，也可能会将该信息提供给并不是性能分析人员的决策者。收集和维护该数据的频率取决于特定的业务需要。

**进行系统监视的方法** 通常有3中方式：

- 通过系统本身提供的命令，如：UNIX/Linux 中的 W、ps、last，Windows中的 netstat 等
- 通过系统记录文件查询系统在特定时间内的运行状态
- 集成命令、文件记录、可视化技术。如 Windows 的 Perfmon 应用程序