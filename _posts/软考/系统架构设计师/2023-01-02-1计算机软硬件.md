---
layout: post
title: 系统架构设计师教程 - 2.1
subtitle: 计算机软硬件
date:   2023-01-02 00:00:00
categories: 软考 系统架构设计师教程
tag: 软考
author: YangLe
---





## 一、计算机系统概述

### 1 定义

**计算机系统（Computer System）是指用于数据管理的计算机硬件、软件及网络组成的系统**。

### 2 组成

它是按人的要求接收和存储信息，自动进行数据处理和计算，并输出结果信息的机器系统。由硬件子系统和软件子系统组成的系统，简称为计算机。而将连接多个计算机以实现计算机间数据交换能力的网络设备，则称之为计算机网络，简称网络。

计算机系统可划分为硬件和软件。

硬件由机械、电子元器件、磁介质、光介质等物理实体构成，包含以下组成部分：

- 处理器（运算单元、控制单元）
- 存储器（主存/内存，外存）
- 输入设备（鼠标、键盘等）
- 输出设备（显示器等）

软件系统分为：

- 系统软件：支持应用软件的运行，为用户开发应用软件提供平台支撑的软件（操作系统、编译工具等）
- 应用软件：是指计算机用户用户利用计算机软、硬件资源为某一专门的应用目的而开发的软件（办公软件、娱乐软件）

### 3 分类

计算机系统的分类维度很多，也较为复杂，可以从硬件的结构、性能、规模上划分，亦可从软件的构成、特征上划分，或者从系统的整体用途、服务对象等进行分类。

#### 3.1 嵌入式计算机

- 电信设备：基站、网络交换、移动终端
- 家用电子设备：视听设备、厨卫电器
- 可穿戴电子设备
- 医疗设备
- 交通设备
- 国防设备
- 金融设备

#### 3.2 通用计算机

- 个人计算机：台式电脑、平板电脑
- 网络服务器：云存储、云计算
- 超级计算机





## 二、计算机硬件

### 1 计算机硬件组成

计算机组成结构（Computer Architecture）源于冯诺依曼计算机结构，该结构成为现代计算机系统发展的基础。冯诺依曼计算机结构将计算机硬件划分为5部分，但在现实的硬件构成中，控制单元和运算单元被集成为一体，封装为通常意义上的处理器（但处理器并不只有上述两部分）；输入设备和输出设备则经常被设计者集成为一体，按照传输过程被划分为总线、接口、外部设备。下面按照处理器、存储器、总线、接口、外部设备进行阐述。



### 2 处理器

处理器（Central Processing Unit，CPU）作为计算机系统运算和控制的核心部件，经历了长期演化过程

- 在位宽上由4位处理器发展到64位处理器；
- 在能力构成上从仅具有运算和控制功能发展到集成多级缓存、多种通信总线和接口
- 在内核上从单核处理器发展为多核、异构多核、众核处理器

处理器的指令集按照其复杂程度可分为：**复杂指令集**（Complex Instruction Set Computers，CISC）与 **精简指令集**（Reduced Instruction Set Computers，RISC）两类。CISC 以 Intel 、AMD 的 x86 CPU 为代表，RISC 以 ARM 和 Power 为代表。随着研究的深入，除了由于历史原因而仍然存在的 CISC 结构外，RISC 已经成为计算机指令集发展的趋势，几乎所有后期出现的指令集均为 RISC 架构。

![图片]({{ '/images/ruankao/framework/2/典型的处理器体系结构示意图.png' | prepend: site.baseurl }})

**指令部件** 通过 MMU-Cache 的存储结构，从 **内存** 等存储设备中取得相应的 **软件代码指令** 并完成 **译码** 和 **控制** 操作，控制 **存取部件** 从 **存储设备** 中取得新的**数据**，控制 **寄存器组** 为 **运算器** 准备有关寄存器**数据**，并准备好 **结果寄存器**，控制整型、浮点、向量等 **运算部件** 开展运算。运算部件、寄存器单元、存取部件 将执行结果通知 **完成部件**，并在 **完成部件** 中完成结果的排队，由 **完成部件** 向 **指令部件** 反馈执行结果，控制 **指令** 的顺序执行、跳转等时序。

随着微电子技术发展，用于专用目的的处理器芯片不断涌现。常见的有：

- 图像处理器（Graphics Processing Unit，GPU）：一种特殊类型的处理器，具有数百或数千个内核，经过优化可并行运行大量计算。在深度学习和机器学习领域得到了广泛应用。
- 信号处理器（Digital Signal Processor，DSP）：专用于实时的数字信号处理，通过采用饱和算法处理溢出问题，通过乘积累加运算提高矩阵运算的效率，以及傅里叶变换设计专用指令等方法，在各类高速信号采集的设备中得到广泛应用。
- 可编程逻辑门阵列（Field Programmable Gate Array，FPGA）



### 3 存储器

存储器是利用半导体、磁、光等介质制成用于存储数据的电子设备。根据存储器的硬件结构可分为 SRAM、DRAM、NVRAM、Flash、EPROM、Disk 等。

计算机系统中的存储器通常采用分层的体系（Memory Hierarchy）结构，按照与处理器的物理距离可分为：

1. 片上缓存：在处理器核心中直接集成的缓存，一般为 SRAM 结构，实现数据的快速读取。它的容量较小，一般为16 ~ 512 KB，按照不同的设计可能划分为一级或二级
2. 片外缓存：在处理器核心外的缓存，需要经过交换互联开关访问，一般也是由 SRAM 构成，容量较片上缓存略大，可以为 256KB ~ 4MB。按照层级被称为 L2Cache 或 L3Cache，或者称为平台Cache（PlatformCache）。
3. 主存（内存）：通常采用 DRAM 结构，以独立的部件/芯片存在，通过总线与处理器连接。DRAM 依赖不断充电维持其中的数据，容量在数百MB至数十GB之间。
4. 外存：可以是磁带、磁盘、光盘和各类Flash 等介质器件，这类设备访问速度慢，但是容量大，且在掉电后能够保持其数据。

| 外存介质类型 | 容量         | 保存数据年限 |
| ------------ | ------------ | ------------ |
| Nor Flash    | MB级别       | 10年左右     |
| 磁盘         | GB ~ TB 级别 | 10年以上     |
| 磁带         |              | 30年以上     |



### 4 总线

总线（Bus）是指计算机部件间遵循某一特定协议实现数据交换的形式，即以一种特定格式按照规定的控制逻辑实现部件间的数据传输。

按照总线在计算机中所处的位置划分为内总线、系统总线、外部总线。

- 内总线：用于各类芯片内部互联，也可称为片上总线（On-Chip Bus）或 片内总线。
- 系统总线：是指计算机中 CPU、主存、I/O 接口的总线。
  - 狭义上：系统总线仍为CPU、主存、通信桥连接的总线
  - 广义上：还包括计算机系统内，经由系统总线再次级联的总线，常被称为局部总线（Local Bus）。
- 外部总线：是计算机板和外部设备之间，或者计算机系统直接互联的总线，又称为通信总线。

总线之间通过**桥**（Bridge）实现连接，它是一种特殊的外设，主要实现总线协议间的转换。总线的性能指标常见的有总线带宽、总线服务、质量QoS、总线时延、总线抖动等。

目前，计算机总线存在许多种类，常见的有并行总线和串行总线。并行总线主要包括 PCI、PCle、ATA(IDE)等，串行总线主要包括 USB、SATA、CAN、RS-232、RS-485、RapidIO、以太网等。在一些专业领域中还定义了多种类型的总线，比如航空领域的 ARINC429、ARINC659、ARINC664、MIL-STD-1553B 等；工业控制领域的 CAN、IEEE1394、PCI、PCle、VME 等。



### 5 接口

接口是指同一计算机不同功能层之间的通信规则。计算机接口有多种，常见的包括：

- 显示类接口：HDMI、DVI 等
- 音频输入输出类接口：TRS、RCA、XLR 等
- 网络类接口：RJ45、FC 等
- PS/2 接口
- USB 接口
- SATA 接口
- LPT 打印机接口
- RS-232接口
- ...

此外，像离散量接口与 A/D 转换接口等这类接口一般属于非标准接口，是随需求而设计。

对于总线而言，一种总线可能存在多种接口，比如，以太网可以通过 RJ-45 或 同轴电缆 与之连接，PCle 总线则具有多种形态的接口实现连接。



### 6 外部设备

外部设备也称为外围设备，是计算机的非必要设备（但各类计算机必然会有一些）。现代计算机的外部设备种类日益丰富，包括所有的输入输出设备以及部分存储设备（即外存）。



## 三、计算机软件

### 1 计算机软件概述

#### 1.1 定义

**计算机软件**：是指计算机系统中的程序及其文档，是计算任务的处理对象和处理规则的描述。

- 计算任务：任何以计算机为处理工具的任务
- 处理对象：数据（如：数字、文字、图形、图像、声音等）或信息（数据及有关的含义）
- 处理规则：一般指处理的动作和步骤
- 文档：是为了方便于了解程序所需的阐述性资料

**软件系统**：是指在计算机硬件系统上运行的程序、相关的文档资料、数据 的集合。

计算机软件用来扩充计算机系统的功能，提高计算机系统的效率。



#### 1.2 分类

按照软件所起的作用和需要的运行环境的不同，通常将计算机软件分为系统软件和应用软件两大类。

##### 1.2.1 系统软件

系统软件：是为整个计算机系统配置的不依赖特定应用领域的通用软件。

系统软件对计算机系统的硬件和软件资源进行控制和管理，并为用户使用和其他应用软件的运行提供服务。根据系统软件功能的不同，可将其划分为：**操作系统**、**程序设计语言翻译系统**、**数据库管理系统**、**网络软件** 等。

##### 1.2.2 应用软件

应用软件：是指 为某类应用需要 或 解决某个特定问题 而设计的软件。如图形图像处理软件、财务软件、游戏软件、各种软件包等。

按照应用软件使用面的不同，可进一步把应用软件分为 专用的应用软件 和 通用的应用软件两类。



### 2 操作系统

操作系统是计算机系统的资源管理者。它包含对系统软件、硬件资源实施管理的一组程序，其首要作用就是通过 CPU 管理、存储管理、设备管理、文件管理 对各种资源进行合理地分配，改善资源的共享和利用程度，最大限度地发挥计算机系统的工作效率，提高计算机系统在单位时间内处理工作的能力。

操作系统是配置在计算机硬件上的第1层软件，它向下管理裸机及其中的文件，向上为其他的系统软件（汇编程序、编译程序、数据库管理系统等）和 大量应用软件提供支持，以及为用户提供方便使用系统的接口。



#### 2.1 组成

它们通常由 **操作系统内核**（Kernel） 和 **其他许多附加的配套软件** 所组成。

**操作系统内核**：是指能提供进程管理（任务管理）、存储管理、文件管理、设备管理 等功能的那些软件模块。

- 是操作系统中最基本的部分，用于为众多应用程序访问计算机硬件提供服务
- 对硬件设备进行了抽象，为应用软件提供了一套简洁、统一的接口（系统调用接口、应用程序接口API）
- 驻留在内存中，以 CPU 最高优先级运行，能执行 指令系统 中的特权指令
- 具有直接访问 各种外设 和 全部主存空间 的特权
- 负责对系统资源进行管理和分配

**其他配套软件** 包括：

- 图形用户界面程序
- 常用的应用程序 （日历、计算器、资源管理器、网络浏览器等）
- 实用程序 （任务管理器、磁盘清理程序、杀毒软件、防火墙等）
- 为支持 应用软件开发和运行 的各种软件构建（应用框架、编译器、程序库）



#### 2.2 作用

1. 管理计算机中运行的程序 和 分配各种软硬件资源
   - 资源分配 和 任务调度，避免冲突，保证程序正常有序的运行
   - 资源管理 主要包括：处理器管理、存储管理、文件管理、I/O 设备管理 等
2. 为用户提供友善的人机界面。使用户能够比较直观、灵活、有效地使用计算机
   - 通过多个窗口分别显示正在运行的各个程序的状态
   - 采用图标（icon）来形象地表示系统中的文件、程序、设备等对象
   - 利用鼠标活触摸屏控制光标移动，通过点击启动某个操作命令的执行，或通过拖动方式执行所需操作
3. 为应用程序的开发和运行提供一个高效率的平台。
   - 屏蔽了几乎所有的物理设备的技术细节，以规范、高效的方式（例如：系统调用、库函数）向应用程序提供有力支持。从而为开发和运行其他系统软件及各种应用提供了一个平台

除了上述3个方面的作用之外，操作系统还具有辅导用户操作（帮助功能）、处理软硬件错误、监控系统性能、保护系统安全等许多作用。有了操作系统，计算机才能成为一个高效、可靠、通用的数据处理系统。



#### 2.3 特征

##### 2.3.1 并发性

在多道程序环境下，并发性是指在一段时间内，宏观上有多个程序同时运行，但实际上在单 CPU 的运行环境，每一个时刻只有一个程序在执行。因此，从微观上来说，各个程序是交替、轮流执行的，如果计算机系统中有多个 CPU，则可将多个程序分配到不同 CPU 上实现并运行。

##### 2.3.2 共享性

共享是指操作系统中的资源（包括硬件资源、信息资源）可以被多个并发执行的进程（线程）共同使用，而不是被一个进程所独占。出于经济上的考虑，一次性向每个用户程序分别提供它所需的全部资源不但浪费，有时也是不可能的。现实的方法是让操作系统和多个用户程序共用一套计算机系统的所有资源，因此必然会产生共享资源的需要。

**共享资源的方式** 可以分为 **同时共享** 和 **互斥共享**。

##### 2.3.3 虚拟性

虚拟性是操作系统的一种管理技术，它是把物理上的一个实体变成逻辑上的多个对应物，或把物理上的多个实体变成逻辑上的一个对应物的技术。采用虚拟技术的目的是为用户提供易于使用且方便高效的操作环境。

##### 2.3.4 不确定性

在多道程序环境中，允许多个进程并发执行，但由于资源有限，在多数情况下进行的执行不是一贯到底的，而是“走走停停”。

例如：一个进程在 CPU 上运行一段时间后，由于 等待资源 或 某事发生，它被暂停执行，将 CPU 转让给另一个进程执行。系统中的进程何时执行，何时暂停，以什么样的速度向前推进，进程总共要花费多少时间执行才能完成，这些都是不可预知的。或者说该进程是以不确定的方式运行的，其导致的直接后果是程序执行结果可能不唯一。



#### 2.4 分类

##### 2.4.1 批处理操作系统

- 单道批处理操作系统：用户可以向系统提交多个作业，单道 的含义是指一次只有一个作业装入内存执行。作业由用户程序、数据、作业说明书（作业控制语言）3个部分组成。当一个作业运行结束后，随即自动调入同批的下一个作业，从而节省了作业之间的人工干预时间，提高了资源的利用率。
- 多道批处理操作系统：允许多个作业装入内存执行，在任意一个时刻，作业都处于开始点和终止点之间。每当运行中的一个作业由于输入/输出操作需要调用外部设备时，就把 CPU 交给另一个等待运行的作业，从而将主机与外部设备的工作由串行改变为并行，进一步避免了因主机等待外设完成任务而浪费宝贵的 CPU 时间。

多道批处理系统主要有3个特点：**多道**、**宏观上并行运行**、**微观上串行运行**。

##### 2.4.2 分时操作系统

分时操作系统中，一个计算机系统与多个终端设备连接。分时操作系统是将 CPU 的工作时间划分为许多很短的时间片，轮流为各个终端的用户服务。

分时系统主要有4个特点：**多路性**、**独立性**、**交互性**、**及时性**。

例如：一个带20个终端的分时系统，若每个用户每次分配一个50ms 的时间片，则每隔1s即可为所有的用户服务一遍。因此，尽管各个终端上的作业是断续进行的，但由于操作系统每次对用户程序都能做出及时响应，因此用户感觉整个系统均归其一人占用。

##### 2.4.3 实时操作系统

实时是指计算机对于外来信息能够以足够快的速度进行处理，并在被控制对象允许的时间范围内做出快速反应。实时系统对交互能力要求不高，但要求可靠性有保障。

实时系统分为 **实时控制系统** 和 **实时信息处理系统**。

- 实时控制系统：主要用于生产过程的自动控制。例如：数据自动采集、武器控制、火炮自动控制、飞机自动驾驶、导弹的制导系统等。
- 实时信息处理系统：主要用于实时信息处理，例如：飞机订票系统、情报检索系统等。

##### 2.4.4 网络操作系统

网络操作系统是使联网计算机能方便而有效地共享网络资源，为网络用户提供各种服务的软件和有关协议的集合。主要功能包括：

- 高效、可靠的网络通信
- 对网络中共享资源（在LAN中有硬盘、打印机等）的有效管理
- 提供电子邮件、文件传输、共享硬盘、打印机等服务
- 网络安全管理
- 提供互操作能力

一个典型的网络操作系统的特征包括 **硬件独立性** 和 **多用户支持** 等。

- 硬件独立性：是指网络操作系统可以运行在不同的网络硬件上，可以通过网桥或路由器与其他网络连接
- 多用户支持：应能同事支持多个用户对网络的访问，应对信息资源提供完全的安全和保护功能
- 支持网络实用程序及其管理功能：如系统备份、安全管理、容错、性能控制
- 多种客户端支持
- 提供目录服务：以单一逻辑的方式让用户访问位于世界范围内的所有网络服务和资源的技术
- 支持多种增值服务：如文件服务、打印服务、通信服务、数据库服务等

##### 2.4.5 分布式操作系统

分布式计算机系统是由多个分散的计算机经连接而成的计算机系统，系统中的计算机无主次之分，任意两台计算机可以通过通信交换信息。通常，为分布式计算机系统配置的操作系统称之为分布式操作系统。

分布式操作系统能直接对系统中的各类资源进行 动态分配和调度、任务划分、信息传输 协调工作，并为用户提供一个统一的界面与标准接口，用户通过这一界面实现所需要的操作和使用系统资源，使系统中若干台计算机相互协作完成共同任务，有效地控制协调诸任务的并行执行。

分布式操作系统是网络操作系统的更高级形式，它保持网络系统所拥有的全部功能，同时又有透明性、可靠性、高性能 等特性。

##### 2.4.6 微型计算机操作系统

微型计算机操作系统简称微机操作系统，常用的有 Windows、Mac OS、Linux。

##### 2.4.7 嵌入式操作系统

嵌入式操作系统运行在嵌入式智能设备环境中，对整个智能硬件以及它所操作、控制的各种部件装置等资源进行统一协调、处理、指挥、控制。其主要特点如下：

- **微型化**：从性能和成本角度考虑，希望占用的资源和系统代码量少，如内存少、字长短、运行速度有限、能源少（微小型电池）
- **可定制**：从减少成本和缩短研发周期考虑，要求嵌入式操作系统能运行在不同的微处理器平台上，能针对硬件变化进行结构与功能上的配置，以满足不同应用需要
- **实时性**：嵌入式操作系统主要应用于过程控制、数据采集、传输通信、多媒体信息及关键要害领域
- **可靠性**：系统构件、模块、体系结构必须达到应有的可靠性，对关键要害应用还要提供容错和防故障措施
- **易移植性**：为了提高系统的易移植性，通常采用 **硬件抽象层**（Hardware Abstraction Level，HAL）和 **板级支撑包**（Board Support Package，BSP）的底层设计技术

常见的嵌入式实时操作系统有 VxWorks、μClinux、PalmOS、WindowsCE、μC/OS-II I和 eCos 等。



### 3 数据库

数据库技术是目前最有效的数据管理技术。

数据库（Database，DB）是指长期存储在计算机内、有组织的、统一管理的相关数据的集合。它不仅描述事物本身，而且还包括相关事物之间的联系。数据库可以直观地理解为存放数据的仓库，只不过这个仓库是在计算机的存储设备上，而且数据是按一定格式存放的，具有较小的冗余的、较高的数据独立性和易扩展性，可为多个用户共享。

早期数据库分为三类：层次数据库、网络式数据库、关系型数据库。

目前最常见的数据库种类：**关系型数据库**、**非关系型数据库**。

根据数据库存储体系分类：**关系型数据库**、**键值数据库**、**列存储数据库**、**文档数据库**、**搜索引擎数据库** 等。

- **关系型数据库**：最传统的数据库类型，把复杂的数据结构归结为简单的二元关系。实际使用就是通过对这些关联的表格进行分类、合并、连接、选取等运算来实现数据库的管理。
- **键值数据库**：一种非关系型数据库，使用简单的键值方法来存储数据。将数据存储为键值对集合，其中键作为唯一标识符。
- **列存储数据库**：相对于传统关系型数据库的行式存储来说的。两者区别就是数据的存储形式的差异。
- **文档数据库**：此类数据库可存放并获取文档，可以是XML、JSON、BSON等格式，这些文档具备可描述性、呈现分层的树状结构，可以包含映射表、集合、纯量值。数据库中的文档彼此相似，但不必完全相同。文档数据库所存放的文档，就相当于键值数据库所存放的 值。文档数据库可视为其值可查的键值数据库。
- **搜索引擎数据库**：搜索引擎数据库是应用在搜索引擎领域的数据存储形式，由于搜索引擎会爬取大量的数据，并以特定的格式进行存储，这样在检索的时候才能保证性能最优。



#### 3.1 关系数据库

数据模型时数据特征的抽象，它是对数据库组织的一种模型化表示，是数据库系统的核心与基础。它具有数据结构、数据操作、完整性约束条件 三要素。

**关系** 可以理解为二维表。一个关系模型就是指用若干关系表示实体及其联系，用二维表的形式存储数据。

##### 3.1.1 设计的特点及方法

数据库设计是指对于一个给定的应用环境 构造最优的数据库，建立数据库及其应用系统，使之能有效的存储数据，满足各种用户的需求。**数据库设计** 包括 **结构特性** 和 **行为特性** 的设计两方面的内容。

数据库**设计特点**有：

- 从数据结构即数据模型开心，并以数据模型为核心展开
- 静态结构设计与动态行为设计分离
- 试探性
- 反复性
- 多步性

**设计方法**可分为4类：**直观设计法**、**规范设计法**、**计算机辅助设计法**、**自动化设计法**。常用的有 ：

- 基于3NF的设计方法
- *基于实体联系（E-R）模型的设计方法
- 基于视图概念的设计方法
- 面向对象的关系数据库设计方法
- 计算机辅助数据库设计方法
- 敏捷数据库设计方法

##### 3.1.2 设计的基本步骤

数据库设计分为6个阶段：需求分析、概念结构设计、逻辑结构设计、物理结构设计、应用程序设计、运行维护。

数据库的设计步骤：

![图片]({{ '/images/ruankao/framework/2/关系型数据库设计步骤.png' | prepend: site.baseurl }})

- **需求分析**：这阶段的认为是对现实世界要处理的对象（组织、部门、企业等）进行详细调查，在了解现行系统的概况和确定新系统功能的过程中，收集支持系统目标的基础数据及其处理方法。需求分析是在用户调查的基础上，通过分析 逐步明确用户对系统的需求，包括数据需求和围绕这些数据的业务处理需求
- **概念结构设计**：是在需求分析的基础上，依照需求分析中的信息需求，对用户信息加以分类、聚集、概况。建立信息模型，并依照选定的数据库管理系统软件，把它们转换为数据的逻辑结构，再依照软硬件环境，最终实现数据的合理存储。这一过程也称为数据建模
  - 最著名、最常用的方法是 **E-R 方法**。E-R方法设计分为三步：设计局部E-R模型、设计全局E-R模型、全局E-R模型优化
- **逻辑结构设计**：可以是层次、网状模型、关系模型。本阶段的主要任务是确定数据模型，将E-R图转换为指定的数据模型，确定完整性约束，确定用户试图
- **物理结构设计**：数据库在物理设备上的存储结构与存取方法 称为**数据库的物理结构**。物理结构设计 是对已确定的数据库逻辑结构，利用 DBMS 所提供的方法、技术，以较优的**存储结构**和**数据存取路径**、**合理的数据存放位置**以及**存储分配**，设计出一个高效的、可实现的数据库物理结构。
  - 数据库应用系统开发 是 DBMS 的二次开发，一方面是对用户信息的存储；另一方面就是对用户处理要求的实现
- **应用程序设计**：本阶段要做的工作有选择设计方法、制定开发计划、选择系统架构、设计安全性策略。设计方法有 **结构化设计方法** 和 **面向对象设计方法** 两种。安全性策略主要是指硬件平台、操作系统、数据库系统、网络及应用系统的安全
- **运行维护**：本阶段要做的工作有数据库的转储和恢复，数据库的安全性和完整性控制，数据库性能的监督、分析、改造，数据库的重组和重构等。



#### 3.2 分布式数据库

分布式数据库系统（Distributed Database System，DDBS）是针对地理上分散，而管理上又需要不同程度集中管理的需求，而提出的一种数据管理信息系统。满足分布性、逻辑相关性、场地透明性、场地自治性的数据库系统 被称为**完全分布式系统**。

分布式数据库系统的**特点**：数据的集中控制性、数据独立性、数据冗余可控性、场地自治性、存取的有效性。

##### 3.2.1 体系结构

我国在多年研究与开发分布式数据库及制定《分布式数据库系统标准》中，提出了把分布式数据库抽象为4层的结构模式：

![图片]({{ '/images/ruankao/framework/2/分布式数据库结构模式.png' | prepend: site.baseurl }})

4层模式划分为**全局外层**、**全局概念层**、**局部概念层**、**局部内层**，在各层间还有相应的层间映射。这种4层模式适用于同构型分布式数据库系统，也适用于异构型分布式数据库系统。

##### 3.2.2 应用

分布式数据库的应用领域有：分布式计算、Internet应用、数据仓库、数据复制、全球联网查询 等。Sybase 公司的 Replication Server 即是一种典型的分布式数据库系统。



#### 3.3 常用数据库管理系统

##### 3.3.1 Oracle

Oracle 是一种适用于大型、中型和微型计算机的关系数据库管理系统。Oracle 的结构包括数据库的内部结构、外存储结构、内存储结构、进程结构。在 Oracle 中，数据库不仅指物理上的数据，还包括处理这些数据的程序，即 DBMS 本身。Oracle 使用 PL/SQL （Procedural Language/SQL）语言执行各种操作。Oracle 除了以关系格式存储数据外，Oracle 8 以上的版本还支持面向对象的结构（如抽象数据类型）。

Oracle 产品主要包括数据库服务器、开发工具、连接产品 三类。Oracle 还提供了一系列的工具产品，如逻辑备份工具 Export、Import 等。

##### 3.3.2 IBM DB2

DB2 是 IBM 的一种分布式数据库解决方案。简单地说，DB2 就是 IBM 开发的一种大型关系型数据库平台，它支持多用户或应用程序在同一条 SQL 语句中查询不同 Database 甚至不同 DBMS 中的数据。

DB2 核心数据库的特色有：支持面向对象编程，支持多媒体应用程序，支持备份和恢复功能，支持存储过程和触发器，支持 SQL 查询，支持异构分布式数据库访问，支持数据复制。

DB2 采用多进程多线索体系结构，可运行于多种操作系统之上。IBM 还提供了 Visuaizer、Visualage、Visualgen 等开发工具。

##### 3.3.3 Sybase

Sybase 是美国 SYBASE 公司在20世纪80年代中期推出的 客户机/服务器（C/S） 结构的关系数据库系统，也是世界上第一个真正的基于客户机/服务器结构的 RDBMS 产品。

Sybase 数据库主要由三部分组成：

- Sybase SQLServer：进行数据库管理和维护的联系关系型数据库管理系统
- Sybase SQLToolset：支持数据库应用系统建立与开发的一组前端工具
- Sybase OpenClient / OpenServer：可把异构环境下其他厂商的应用软件和任何类型的数据连接在一起的接口

Sybase 提供了Sybase Adaptive Server Enterprise 高性能企业只能型关系数据库管理系统、EAServer 电子商务解决方案应用服务器、系统分析设计工具 PowerDesigner、应用开发工具 PowerBuilder。

##### 3.3.4 Microsoft SQL Server

Microsoft SQL Server 是一种典型的关系型数据库管理系统，可运行于多个操作系统上，它使用 Transact-SQL 语言完成数据操作。

SQL Server 的基本服务器组件包括：

- Open Data Services
- MS SQL Server
- SQL Server Agent
- MSDTC（Microsoft Distributed Transaction Coordinator）

SQL Server 数据平台包括以下工具：关系型数据库、复制服务、通知服务、集成服务、分析服务、报表服务、管理工具、开发工具。



#### 3.4 大型数据库管理系统的特点

大型数据库管理系统，主要有以下7个特点：

1. 基于网络环境的数据库管理系统。可以用于 C/S 结构的数据库应用系统，也可以用于 B/S 结构的数据库应用系统。
2. 支持大规模的应用。可支持数千个并发用户、多达上百万的事物处理和超过数百GB的数据容量。
3. 提供的自动锁功能使得并发用户可以安全而高效的访问数据
4. 可以保证系统的高度安全性
5. 提供方便而灵活的数据备份和恢复方法及设备镜像功能，还可以利用操作系统提供容错功能，确保设计良好的应用中的数据在发生意外的情况下可以最大限度地被恢复。
6. 提供多种维护数据完整性的手段
7. 提供了方便易用的分布式处理功能



### 4 文件系统

#### 4.1 文件与文件系统

**文件**（File）是具有符号名的、在逻辑上具有完整意义的一组相关信息项的集合。文件是一种抽象机制，它隐藏了硬件和实现细节，提供了将信息保存在外存上而且便于以后读取的手段，使用户不必了解信息存储的方法、位置以及存储设备实际操作方式 便可存取信息。

一个文件包括：文件体、文件说明。

- **文件体**：是文件真实的内容
- **文件说明**：是操作系统为了管理文件所用到的信息。包括：文件名、文件内部标识、文件类型、文件存储地址、文件长度、访问权限、建立时间、访问时间等

**文件系统**：是操作系统中实现文件统一管理的一组软件和相关数据的集合，是专门负责管理和存取文件信息的软件机构。

文件系统的功能包括：

- 按名存取：即用户可以 按名存取，而不是 按地址存取
- 统一的用户接口，在不同设备上提供统一的接口，方便用户操作和编程
- 并发访问和控制，在多道程序系统中支持对文件的并发访问和控制
- 优化性能，采用相关技术提高系统对文件的存储效率、检索和读写性能
- 差错恢复，能够验证文件的正确性，并具有一定的差错恢复能力



#### 4.2 文件的类型

1. 按文件 **性质和用途** 分类：系统文件、库文件、用户文件
2. 按文件 **信息保存期限** 分类：临时文件、档案文件、永久文件
3. 按文件 **保护方式** 分类：只读文件、读写文件、可执行文件、不保护文件
4. UNIX系统 将文件分为：普通文件、目录文件、设备文件（特殊文件）

目前常用的文件系统类型有 **FAT**、**VFAT**、**NTFS**、**Ext2**、**HPFS** 等。

文件分类的目的是对不用文件进行管理，提高系统效率，提高用户界面友好性。当然，根据文件的存取方式和物理结构不同，还可以将文件分为不同的类型。



#### 4.3 文件的结构和组织

**文件的结构** 是指文件的组织形式。

- 逻辑结构：从用户角度看到的文件组织形式
- 物理结构：文件在文件存储器上的存放方式

##### 4.3.1 逻辑结构

文件的逻辑结构可分为两大类：

- **有结构的记录式文件**：由一个以上的记录构成的文件。所有的记录通常都是描述一个实体集的，有着相同或不同数目的数据项，记录的长度可分为定长和不定长两类。（定长：文件中所有记录的长度相同）
- **无结构的流式文件**：由一串顺序字符流构成的文件。文件体为字节流，不划分记录。无结构的流式文件通常采用顺序访问方式，并且每次读/写访问可以指定任意数据长度，其长度以字节为单位。对于流式文件的访问，是利用读写指针指出下一个要访问的字符。可以把流式文件看作式记录式文件的一个特例

##### 4.3.2 物理结构

文件的物理结构是指文件的内部组织形式，即文件在物理存储设备上的存放方法。由于文件的物理结构决定了文件在存储设备上的存放位置，所以文件的逻辑块号到物理块号的转换也是由文件的物理结构决定的。

常见的的物理结构：

1. 连续结构：也称顺序结构，它将逻辑上连续的文件信息依次存放在连续编号的物理块上。只要知道文件的起始物理块号和文件的长度，就可以很方便的进行文件存取
2. 链接结构：也称串联结构。它是将逻辑上连续的文件信息存放在不连续的物理块上，每个物理块设有一个指针指向下一个物理块。因此，只要知道第一个物理块号，就可以按链指针查找整个文件。
3. 索引结构：将逻辑上连续的文件信息存放在不连续的物理块中，系统为每个文件建立一张索引表。索引表记录了文件信息所在的逻辑块号对应的物理块号，并将索引表的起始地址存放在与文件对应的文件目录项中。
4. 多个物理块的索引表：索引表是在文件创建时有系统自动建立的，并与文件一起存放在同一文件卷上。根据一个文件大小的不同，其索引表

#### 4.4 存取方法和存储空间管理

##### 4.4.1 文件的存取方法

文件的存取方法是指读/写文件存储器上的一个物理块的方法。

通常有两种方法：顺序存取、随机存取。

- 顺序存取：是指对文件中的信息按顺序依次进行读写
- 随机存取：是指对文件中的信息可以按任意的次序随机的读写

##### 4.4.2 存储空间管理

**外存空闲空间管理**的数据结构通常称为：**磁盘分配表**（Disk Allocation Table）。

常用的空闲空间管理方法有：空闲区表、位示图、空闲块链 3种。

###### 4.4.2.1 空闲区表

将外存空间上的一个连续的未分配区域称为 **空闲区**。操作系统为磁盘外存上的所有空闲区建立一张空闲表，每个表项对应一个空闲区，**空闲表**中包含**序号**、**空闲区的第1块号**、**空闲块的块数**、**状态** 等信息。它适用于**连续文件结构**。

空闲区表示例：

| 序号 | 第1个空闲块号 | 空闲块数 | 状态 |
| ---- | ------------- | -------- | ---- |
| 1    | 18            | 5        | 可用 |
| 2    | 29            | 8        | 可用 |
| 3    | 105           | 19       | 可用 |
| 4    | ——            | ——       | 未用 |



###### 4.4.2.2 位示图

这种方法是在外存上建立一张位示图（Bitmap），记录文件存储器的使用情况。

每一位对应文件存储器上的一个物理块，取值0和1比分别表示空闲和占用。

这种方法的主要特点：位示图的大小由磁盘空间的大小（物理块总数）决定，位示图描述能力强，适合各种物理结构。

位示图示例：

![图片]({{ '/images/ruankao/framework/2/位示图示例.png' | prepend: site.baseurl }})



###### 4.4.2.3 空闲块链

每个空闲物理块中有指向下一个空闲物理块的指针，所有空闲物理块构成一个链表，链表的头指针放在文件存储器的特定位置上（如管理块中），不需要磁盘分配表，节省空间。每次申请空闲物理块只需根据链表的头指针取出第1个空闲物理块，根据第一个空闲物理块的指针可找到第2个空闲物理块，依次类推。



###### 4.4.2.4 成组链接法

UNIX 系统采用该方法。例如：在实现时 系统将空闲块分成若干组，每100个空闲块为一组，每组的第一个空闲块登记了下一组空闲块的物理盘块号和空闲块总数。假如某个组的第一个空闲块号等于0，意味着该组时最后一组，无下一组空闲块。



#### 4.5 共享和保护

##### 4.5.1 文件的共享

文件共享是指不同用户进程使用同一文件，它不仅是不同用户完成同一任务所必须的功能，还可以节省大量的主存空间，减少由于文件复制而增加的访问外存次数。

文件共享有多种形式，采用文件名和文件说明分离的目录结构 有利于实现文件共享。常见的文件链接有 **硬链接** 和 **符号链接** 两种。

- **硬链接**：是指两个文件目录表目指向同一个文件实体的链接，该链接也称基于索引结点的链接。换句话说，硬链接是指不同文件名与同一个文件实体的链接。文件硬链接不利于文件主删除它所有的文件，因为文件主 要删除它拥有的共享文件，必须首先删除（关闭）所有的硬链接，否则就会造成共享该文件的用户的目录表目指针悬空。
- **符合链接**：符号链接建立新的文件或目录，并与原来文件或目录的路径名进行映射，当访问一个符号链接时，系统通过该映射找到原文件路径，并对其进行访问。采用符号链接可以跨越文件系统，甚至可以通过计算机网络连接到世界上任何地方的机器中的文件，此时只须提供该文件所在的地址以及在该机器中的文件路径。

##### 4.5.2 文件的保护

文件系统对文件的保护常采用存取控制的方式进行。所谓存取控制，就是规定不同的用户对文件的访问有不同的权限，以防止文件被未经文件主同意的用户访问。

保护方式：存取控制矩阵、存取控制表、用户权限表、密码



### 5 网络协议

在计算机网络中要实现资源共享以及信息交换，必须实现不同系统中实体的通信。两个实体想要成功通信，它们必须具有相同的语言，在计算机网络中称为协议（或规程）。

所谓协议，指的是网络中的计算机与计算机进行通信时，为了能够实现数据的正常发送与接收 必须要遵循的一些事先约定好的规则（标准或约定），在这些规程中明确规定了通信时的**数据格式**、**数据传送时序**以及**相应的控制信息**和**应答信号**等内容。

常用的网络协议包括：局域网协议（LAN）、广域网协议（WAN）、无线网协议、移动网协议。互联网使用时 TCP/IP 协议簇。



### 6 中间件

由于应用软件是在系统软件基础上开发和运行的，而系统软件又有多种，如果每种应用软件都要提供能在不同系统上运行的版本，开发成本将大大增加。因此出现了一类称为 **中间件** 的软件，他们作为应用软件与各种操作系统之间使用的标准化编程接口和协议，可以起承上启下的作用，使应用软件的开发相对独立于计算机硬件和操作系统，并能在不同的系统上运行，实现相同的应用功能。

中间件是基础软件的一大类，属于可复用软件的范畴。中间件处在操作系统、网络和数据库之上，应用软件的下层。

#### 6.1 中间件分类

按照中间件在分布式系统中承担的职责不同，可以划分以下几类中间件产品：

##### 6.1.1 通信处理（消息）中间件

在分布式系统中，人们要建网和制定出通信协议，以保证系统能在不同平台之间通信，实现分布式系统中可靠的、高效的、实时的跨平台数据传输，这类中间件称为消息中间件，也是市面上销售额最大的中间件产品，目前主要产品有：BEA 的 eLink、IBM 的 MQSeries、TongLINK 等。实际上，一般的网络操作系统如Windows 已经包含了其部分功能。

##### 6.1.2 事务处理（交易）中间件

在分布式事务处理系统中，经常要处理大量事务，特别是 OLTP 中，每项事务常常要多台服务器上的程序按顺序协调完成，一旦中间发生某种故障，不但要完成恢复工作，而且要自动切换系统保证系统永不停机，实现高可靠性运行。要使大量事务在多台应用服务器上能实时并发运行，并进行负载平衡的调度，实现与昂贵的可靠性机和大型计算机系统的同等功能，为了实现这个目标，要求中间件系统具有监听和调度整个系统的功能。

BEA 的 Tuxedo 由此而闻名，它成为增长率最高的厂商。

##### 6.1.3 数据存取管理中间件

在分布式系统中，重要的数据都集中存放在数据服务器中，它们可以是关系型的，复合文档型、具有各种存放格式的多媒体型，或者是经过加密或压缩存放的，该中间件将为在网络上虚拟缓冲存取、格式转换、解压等带来方便。

##### 6.1.4 Web服务中间件

浏览器图形用户界面已成为公认规范，然而它的会话能力差，不擅长做数据的写入任务，受 HTTP 协议的限制多等，就必须对其进行修改和扩充，因此出现了Web服务器中间件，如 SilverStream 公司的产品。

##### 6.1.5 安全中间件

一些军事、政府、商务部门上网最大障碍是安全保密问题，而且不能使用国外提供的安全措施（如防火墙、加密、认证等），必须用国产产品。产生不安全因素是由操作系统引起的，但必须要用中间件去解决，以适应灵活多变的要求。

##### 6.1.6 跨平台和架构的中间件

当前开发大型应用软件通常采用基于架构和构件技术，在分布式系统中，还需要集成各结点上的不同系统平台上的构件或新老版本的构件，由此产生了架构中间件。

- 功能最强的是 CORBA，可以跨任意平台，但是其过于庞大
- JavaBeans 较灵活简单，很适合用于浏览器，但运行效率有待改善
- COM+ 模型主要适合 Windows 平台，已在桌面系统广泛使用。

由于国内新建系统多基于 UNIX（包括Linux）和 Windows，因此，针对这两个平台建立相应的中间件市场相对要大得多。

##### 6.1.7 专用平台中间件

为特定应用领域设计领域参考模式，建立相应架构，配置相应的构件库和中间件，为应用服务器开发和运行特定领域的关键任务（如电子商务、网站等）

##### 6.1.8 网络中间件

它包括网管、接入、网络测试、虚拟社区、虚拟缓存 等，也是当前最热门的研发项目。



#### 6.2 中间件产品介绍

##### 6.2.1 IBM MQSerise

IBM 公司的 MQSeries 是 IBM 的消息处理中间件。MQSeries 提供一个具有工业标准、安全、可靠的消息传输系统，它用于控制和管理一个集成的系统，使得组成这个系统的多个分支应用（模块）之间通过传递消息完成整个工作流程。MQSeries 基本由 **一个信息传输系统** 和 **一个应用程序接口** 组成，其资源是**消息和队列**。

MQSeries 的关键功能之一是确保信息的可靠传输，即使在网络通信不可靠或出现异常时也能保证信息的传输。MQSeries 的异步消息处理技术能够保证当网络或者通信应用程序本身处于 忙 状态或发生故障时，系统之间的消息不会丢失，也不会阻塞。这样的可靠性是非常关键的，否则大量的金钱和客户信誉就会面临极大的损害。

同时，MQSeries 是灵活的应用程序通信方案。MQSeries 支持所有的主要计算平台和通信模式，也能够支持先进的技术（如 Internet、Java）拥有连接至主要产品（如 LotusNotes 和 SAP/R3 等）的接口。

##### 6.2.2 BEA Tuxedo

BEA 公司的 Tuxedo 作为电子商务交易平台，属于交易中间件。它允许客户机和服务器参与一个涉及多个数据库协调更新的交易，并能够确保数据的完整性。BEA Tuxedo 一个特色功能是能够保证对电子商务应用系统的不间断访问。它可以对系统构件进行持续的监视，查看是否有应用系统、交易、网络及硬件的故障。一旦出现故障，BEA Tuxedo 会从逻辑上把故障构件排除，然后进行必要的恢复性步骤。

BEA Tuxedo 根据系统的负载指示，自动开启和关闭应用服务，可以均衡所有系统的负载，以满足对应用系统的高强度使用需求。借助DDR（数据依赖路由），BEA Tuxedo 可按照消息的上下文来选择消息路由。其交易队列功能，可使分布式应用系统以异步 少连接 方式协同工作。

BEA Tuxedo 的 LLE 安全机制可确保用户数据的保密性，应用、交易管理接口为50多种硬件平台和操作系统提供了一致的应用编程接口。BEA Tuxedo 基于网络的图形界面管理可以简化对电子商务的管理，为建立和部署电子商务应用系统提供了端到端的电子商务交易平台。



### 7 软件构件





### 8 应用软件


