---
layout: post
title:  GIS 坐标系
date:   2024-03-13
categories: GIS
tag: GIS
author: YangLe
---


## 经纬度与GCS

**G**eographic **C**oordinate **S**ystem, 地理坐标系统



为了能让地球出现在数学家的公式里，我们曾经走过了2个阶段：用平静的海面描述地球 -> 用虚拟的旋转椭球面描述地球表面。

旋转椭球面的标准方程：
$$
(x²+y²)/a²+z²/b²=1
$$
![图片]({{ '/images/gis/640.jpg' | prepend: site.baseurl }})



### 参心坐标系、地心坐标系

地球只有一个质心，只是测不测的精确的问题而已。由地球的唯一性和客观存在，以地球质心为旋转椭球面的中心的坐标系，叫地心坐标系，且唯一。由于a、b两个值的不同，就有多种表达方式，例如，CGCS2000系，WGS84系等。

**地心坐标系又名协议地球坐标系，与GPS中的瞬时地球坐标系要对应起来**

但是又有一个问题——政治问题，地图是给一个国家服务的，那么这地图就要尽可能描述准确这个国家的地形地貌，尽量减小误差，至于别国就无所谓。所以，就可以人为的把地球的质心“移走”，将局部的表面“贴到”该国的国土，使之高程误差尽量减小到最小。

这个时候，就出现了所谓的“**参心坐标系**”。即椭球中心不在地球质心的坐标系，绿色的球就是为了贴合赤道某个地方而产生了平移的参心系

![图片]({{ '/images/gis/参心坐标系.jpg' | prepend: site.baseurl }})

我国常用的参心系及对应椭球：

- 北京54坐标系：克拉索夫斯基椭球体
- 西安80坐标系：IAG75椭球体

我国常用的地心系及对应椭球：

- WGS84坐标系：WGS84椭球体 （GPS星历的坐标系，全球统一使用，最新版于2002年修正）
- CGCS2000坐标系：CGCS2000椭球体 （事实上，CGCS2000椭球和WGS84椭球极为相似，偏差仅有0.11mm，完全可以兼容使用）

有偏差是因为WGS84系是GPS的坐标系，而我国北斗定位则是需要自己的坐标系，就搞了一波CGCS2000。



### 我国常见GCS

#### 北京54坐标系

新中国成立以后，我国大地测量进入了全面发展时期，再全国范围内开展了正规的，全面的大地测量和测图工作，迫切需要建立一个参心大地坐标系。由于当时的“一边倒”政治趋向，故我国采用了前苏联的克拉索夫斯基椭球参数，并与前苏联1942年坐标系进行联测，通过计算建立了我国大地坐标系，定名为1954年北京坐标系。因此，1954年北京坐标系可以认为是前苏联1942年坐标系的延伸。它的原点不在北京而是在前苏联的普尔科沃。



#### 西安80坐标系

改革开放啦，国家商量要搞一个更符合国用的坐标系——西安80坐标系，该坐标系的大地原点设在我国中部的陕西省泾阳县永乐镇，位于西安市西北方向约60公里。



#### WGS84坐标系

全称World Geodetic System - 1984，是为了解决GPS定位而产生的全球统一的一个坐标系。



#### CGCS2000坐标系

2000国家大地坐标系是全球地心坐标系在我国的具体体现，其全称为China Geodetic Coordinate System 2000，其原点为包括海洋和大气的整个地球的质量中心



| 坐标系名      | 北京54              | 西安80         | WGS84               | CGCS2000            |
| ------------- | ------------------- | -------------- | ------------------- | ------------------- |
| 参考椭球      | Krasovsky椭球       | IAG75椭球      | WGS84椭球           | CGCS2000            |
| 椭球极半径b   | 6356863.0187730473m | 6356755m       | 6356752.3142451795m | 6356752.3141403558m |
| 椭球赤道半径a | 6378245m            | 6378140m       | 6378137 m           | 6378137m            |
| 扁率          | 1/298.3             | 1/298.25722101 | 1/298.257223563     | 1/298.257222101     |
| 参考水准面    | 56黄海系            | 85黄海系       |                     | 85黄海系            |
| ArcGIS中WKID  | 4214                | 4610           | 4326                | 4490                |



**CGCS2000的定义与WGS84实质一样。采用的参考椭球非常接近。扁率差异引起椭球面上的纬度和高度变化最大达0.1mm。当前测量精度范围内，可以忽略这点差异。可以说两者相容至cm级水平**



## 平面坐标与PCS

**P**rojection **C**oordinate **S**ystem, 投影坐标系统



PCS：建立一个新的坐标系使得地图分析、空间分析得以定量计算

即：**PCS=GCS+投影方式**



我国常用的6种投影方式：

1. 高斯克吕格（Gauss Kruger）投影=横轴墨卡托（Transverse Mercator）投影
2. 墨卡托（Mercator）投影
3. 通用横轴墨卡托（UTM）投影
4. Lambert投影
5. Albers投影
6. Web Mercator（网络墨卡托）投影



## 火星坐标

火星坐标这个东西很常见，出现在互联网地图上。例如百度、腾讯、谷歌等地图。

火星坐标系原名国测局坐标系（GCJ-02）

出于保密等政治因素，地图的GCS坐标值，会被一种特殊的数学函数加密一次，会偏离真实坐标数百米的距离，但是反馈到用户端的却是正确的位置信息（也就是说你拿到GCS坐标也没用，拿GPS到实地跑跟拿着地图定位，可能会偏出几十米甚至一百米的距离）。



## 开源项目

1. **xdh-map** - 基于Openlayers的地图应用Vue组件
2. **L7** - 是由蚂蚁金服 AntV 数据可视化团队推出的基于 WebGL 的开源大规模地理空间数据可视分析开发框架
3. **pygeo-tutorial** - 用python分析时空数据的教程
4. **vue3-ts-cesium-map-show** - 前端 vue3.0 + typescript 三维可视化 数字城市 数字孪生 选用 cesium开源GIS库
5. **java_map_download** - 使用Java开发的地图瓦片图下载工具，支持OpenStreetMap、天地图、谷歌地图、高德地图、腾讯地图、必应地图的XYZ瓦片图下载与合并。
6. **mars3d** - 一款基于WebGL技术实现的三维地球客户端开发平台
7. **open-geo-modeller** - 地球流体力学模拟系统



| 项目                    | 仓库                                                | 文档                                   |
| ----------------------- | --------------------------------------------------- | -------------------------------------- |
| xdh-map                 | https://gitee.com/newgateway/xdh-map                | https://newgateway.gitee.io/my/ui/map/ |
| L7                      | https://github.com/antvis/L7                        | https://l7.antv.antgroup.com/          |
| pygeo-tutorial          | https://github.com/ni1o1/pygeo-tutorial             |                                        |
| vue3-ts-cesium-map-show | https://gitee.com/hawk86104/vue3-ts-cesium-map-show |                                        |
| java_map_download       | https://github.com/kurimuson/java_map_download      |                                        |
| mars3d                  | https://github.com/marsgis/mars3d                   |                                        |
| open-geo-modeller       | https://github.com/openmaptiles                     |                                        |



## 空间数据库

空间数据库像存储和操作数据库中其他任何对象一样去存储和操作空间对象。

- 空间数据类型：用于指定图像为点（Point）、线（Line）、面（Polygon）
- 多维度空间索引被用于进行空间操作的高效处理
- 空间函数构建于SQL语言中，用于进行空间属性和空间关系的查询

### 空间函数

空间数据库为分析几何信息、确定空间关系和操作几何图形提供了一套完整的空间函数。

1. 转换：在 geometry 和外部数据格式之间进行转换的函数
2. 管理：管理关于空间表和 PostGIS 组织的信息的函数
3. 检索：检索几何图形的属性和空间信息测量的函数
4. 比较：比较两种几何图形的空间关系的函数
5. 生成：基于其他几何图形生成新图形的函数

为什么不直接使用文件存储空间数据：

1. **文件需要特殊的应用程序才能读写**：SQL 是对随机数据访问和分析的抽象。如果没有这种抽象，你将需要自己编写所有的访问和分析数据的代码（就是数据和应用程序耦合）
2. **并发操作可能导致损坏数据**：虽然可以编写额外的代码以确保对同一文件的多次写入不会损坏数据，但当你解决了问题并同时解决了相关的性能问题，你已经编写了数据库的事务管理器，为什么不直接使用标准数据库呢
3. **复杂的问题需要复杂的应用程序来应对**：复杂而有趣的空间分析问题（空间连接、聚合等）可以在数据库中使用一行 SQL 代码来表达，但是在对文件进行编程时，需要数百行专门的代码来解决。

