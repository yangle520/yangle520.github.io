---
layout: post
title: redis 进阶
date:   2024-08-08
categories: 数据库
tag: 数据库
author: YangLe
---



### Redis 事务机制

Redis 通过 MULTI、EXEC、WATCH 等一组命令集合，来实现事务机制。事务支持一次执行多个命令，一个事务中所有命令都会被序列化。在事务执行过程，会按照顺序串行化执行队列中的命令，其他客户端提交的命令请求不会插入到事务执行命令序列中。

Redis 事务就是 顺序性、一次性、排他性 的执行一个队列中的一系列命令。要么命令全部执行，要么全部不执行。在事务执行的过程中，即使**事务中有某条/某些命令执行失败了，事务队列中的其他命令仍然会继续执行**，reids 不会停止执行事务中的命令。

执行事务的流程如下：

- 开始事务 （MULTI）
- 命令入队
- 执行事务（EXEC）、撤销事务（DISCARD）



### Redis 的 Hash 冲突

**哈希冲突**：不同的key，计算出一样的哈希值，导致落在同一个哈希桶中。

Redis 采用了 **链式哈希** 解决哈希冲突。多个元素用一个链表来保存，它们之间一次用指针连接。

为了保持高效，Redis 会对哈希表做 rehash 操作，也就是增加哈希桶，减少冲突。为了 rehash 更高效，Redis 还默认使用了两个全局哈希表，一个用于当前使用，称为主哈希表，一个用于扩容，称为备用哈希表。

![图片]({{ '/images/database/redis/哈希表冲突解决.webp' | prepend: site.baseurl }})



### Redis 与 Memcache 区别

1. Redis 除了支持 K/V 结构，同时还提供了list、set、hash 等数据结构。Memcache 数据结构单一
2. Redis 支持数据持久化（RDB、AOF）。Memcache不支持

